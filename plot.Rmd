---
title: "plot"
author: "Courtney Chan"
date: "October 28, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Problem 2 plots for HW 4

##Loading the necessary libraries.

```{r loading packages}
library(tidyverse)
library(viridis)

library(p8105.datasets)

library(plotly)
```

Preliminary steps to clean the data and recode the variable names of day of the week.

```{r naming dataset and values}

instacart = janitor::clean_names(instacart) %>% mutate(order_dow = recode(order_dow, `0` = "Sunday", `1` = "Monday", `2` = "Tuesday", `3` = "Wednesday", `4` = "Thursday", `5` = "Friday", `6` = "Saturday")) %>% 
  mutate(order_dow = forcats::fct_relevel(order_dow, c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))) %>%
  rename(hour = order_hour_of_day) %>% 
  rename( day = order_dow)

```

Since the original datset is too large, I am taking a sample of 5000 observations.

```{r taking a sample of the original data}

samp_instacart = 
  instacart %>% 
  sample_n(5000)

```

##Creating a line graph

Using our sample of 5000, I created a line graph, plotting the hour of the day and number of orders received. 

```{r line graph}

samp_instacart %>%
  group_by(hour) %>%
  summarize(orders = n()) %>% plot_ly(x = ~hour, y = ~orders, type = "scatter", mode = "lines",
          alpha = 0.5)

```

Looking at this plot, as the day goes on, the number of orders greatly increases. The number of orders start to rise at about hour 6, with a sharp increase to peak orders of approximately 400 around 11. From there, the number of orders declines, dropping off more sharply at hour 17.



##Creating a box plot

```{r creating box plot}
samp_instacart %>%
  plot_ly(x = ~day, y = ~hour, type = "box")

```

A boxplot is created to illustrate the distribution of orders made on each day of the week and hour of the day. The median number of orders made throughout all days of the week occurs around 13 orders. Sunday has the smallest window in time that which orders are made - starting at hour 5 to hour 23. Wednesday, Thursday and Friday have the largest time windows during which orders are made.



##Creating a bar graph

```{r creating bar graph}
samp_instacart %>%
  group_by(department) %>%
  summarize(orders = n()) %>%
  mutate(department = fct_reorder(department, orders)) %>% plot_ly(x = ~department, y = ~orders, type = "bar")

```

The two departments that received the most orders were produce and dairy/eggs. The two departments that received the least orders were bulk and other.
